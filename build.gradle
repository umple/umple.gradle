apply plugin: 'groovy'

// Unless overridden in the pluginBundle config DSL, the project version will
// be used as your plugin version when publishing
group 'cruise.umple'
version '0.1.0'
sourceCompatibility = '1.8'

repositories {
    mavenCentral()
}

dependencies {
    compile gradleApi()
    compile localGroovy()
    compile files('libs/umple-latest.jar')

    testCompile group: 'junit', name: 'junit', version: '4.11'
}

// First, apply the publishing plugin
buildscript {
  repositories {
    maven {
      url "https://plugins.gradle.org/m2/"
    }
	jcenter()
  }
  dependencies {
    classpath "com.gradle.publish:plugin-publish-plugin:0.9.6"
	classpath 'de.undercouch:gradle-download-task:3.1.2'
  }
}

apply plugin: 'de.undercouch.download'
apply plugin: "com.gradle.plugin-publish"
apply plugin: 'maven'

download {
	onlyIfNewer = true
	overwrite = true
    src 'http://cruise.eecs.uottawa.ca/umpleonline/scripts/umple.jar'
    dest '/libs/umple-latest.jar'
}

uploadArchives {
    repositories {
        mavenDeployer {
            repository(url: uri('libs/'))
        }
    }
}

// Apply other plugins here, e.g. java plugin for a plugin written in java or
// the groovy plugin for a plugin written in groovy

// If your plugin has any external java dependencies, Gradle will attempt to
// downloaded them from JCenter for anyone using the plugins DSL
// so you should probably use JCenter for dependency resolution in your own
// project.
repositories {
  jcenter()
}

dependencies {
  compile gradleApi()
  compile localGroovy() //not needed for Java plugins
  compile files('./umple-latest.jar')
}

// The configuration example below shows the minimum required properties
// configured to publish your plugin to the plugin portal
pluginBundle {
  website = 'http://cruise.eecs.uottawa.ca/umple/'
  vcsUrl = 'https://github.com/umple/umple'
  description = 'Compile Umple files in Gradle. See the ReadMe at https://github.com/umple/umple.gradle for additional information.'
  tags = ['umple']

  plugins {
    greetingsPlugin {
      id = 'umple.gradle.plugin'
      displayName = 'Umple Plugin'
    }
  }
}